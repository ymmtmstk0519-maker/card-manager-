<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚«ãƒ¼ãƒ‰ç®¡ç†</title>
<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f5f5f5;
  padding: 12px;
}
h1 { font-size: 20px; }

.input-area, .filter-area {
  background: #fff;
  padding: 10px;
  border-radius: 8px;
  margin-bottom: 12px;
}

input[type="text"], input[type="number"], select {
  padding: 6px;
  font-size: 14px;
  margin-bottom: 6px;
}

input[type="number"] { width: 50px; }

label { margin-right: 6px; font-size: 13px; }

button {
  padding: 4px 8px;
  font-size: 12px;
  margin-left: 4px;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: #fff;
}

th, td {
  border: 1px solid #ccc;
  padding: 6px;
  font-size: 13px;
}

th { background: #eee; }

img { max-width: 40px; }

.card-name {
  font-size: 15px;
  font-weight: 600;
}

.count-input {
  width: 50px;
  font-size: 12px;
}

.pack-item {
  margin-bottom: 4px;
}
</style>
</head>
<body>

<h1>ã‚«ãƒ¼ãƒ‰ç®¡ç†</h1>

<div class="input-area">
  <input id="name" type="text" placeholder="ã‚«ãƒ¼ãƒ‰å"><br>

  <strong>ã‚¯ãƒ©ã‚¹</strong><br>
  <div id="classArea">
    <label><input type="checkbox" value="ã‚¨ãƒ«ãƒ•">ã‚¨ãƒ«ãƒ•</label>
    <label><input type="checkbox" value="ãƒ­ã‚¤ãƒ¤ãƒ«">ãƒ­ã‚¤ãƒ¤ãƒ«</label>
    <label><input type="checkbox" value="ã‚¦ã‚£ãƒƒãƒ">ã‚¦ã‚£ãƒƒãƒ</label>
    <label><input type="checkbox" value="ãƒ‰ãƒ©ã‚´ãƒ³">ãƒ‰ãƒ©ã‚´ãƒ³</label>
    <label><input type="checkbox" value="ãƒŠã‚¤ãƒˆãƒ¡ã‚¢">ãƒŠã‚¤ãƒˆãƒ¡ã‚¢</label>
    <label><input type="checkbox" value="ãƒ“ã‚·ãƒ§ãƒƒãƒ—">ãƒ“ã‚·ãƒ§ãƒƒãƒ—</label>
    <label><input type="checkbox" value="ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«">ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«</label>
    <label><input type="checkbox" value="ã‚³ãƒ©ãƒœ">ã‚³ãƒ©ãƒœ</label>
  </div>

  <strong>ã‚«ãƒ¼ãƒ‰ãƒ‘ãƒƒã‚¯</strong><br>
  <input id="newPack" type="text" placeholder="æ–°ã—ã„ã‚«ãƒ¼ãƒ‰ãƒ‘ãƒƒã‚¯å">
  <button onclick="addPack()">è¿½åŠ </button>

  <div id="packArea"></div>
  <hr>
  <div id="packEditArea"></div>

  <strong>ç¨®åˆ¥</strong><br>
  <label><input type="radio" name="realType" value="æœ¬ç‰©" checked>æœ¬ç‰©</label>
  <label><input type="radio" name="realType" value="ãƒ—ãƒ­ã‚­ã‚·">ãƒ—ãƒ­ã‚­ã‚·</label><br>

  <input id="count" type="number" min="1" placeholder="æšæ•°">
  <input id="image" type="file" accept="image/*"><br>

  <button onclick="addCard()">è¿½åŠ </button>
</div>

<div class="filter-area">
  ğŸ” <input id="search" placeholder="ã‚«ãƒ¼ãƒ‰åæ¤œç´¢"><br>

  <select id="filterClass">
    <option value="">å…¨ã‚¯ãƒ©ã‚¹</option>
    <option>ã‚¨ãƒ«ãƒ•</option><option>ãƒ­ã‚¤ãƒ¤ãƒ«</option><option>ã‚¦ã‚£ãƒƒãƒ</option>
    <option>ãƒ‰ãƒ©ã‚´ãƒ³</option><option>ãƒŠã‚¤ãƒˆãƒ¡ã‚¢</option>
    <option>ãƒ“ã‚·ãƒ§ãƒƒãƒ—</option><option>ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«</option><option>ã‚³ãƒ©ãƒœ</option>
  </select>

  <select id="filterType">
    <option value="">å…¨ç¨®åˆ¥</option>
    <option>æœ¬ç‰©</option>
    <option>ãƒ—ãƒ­ã‚­ã‚·</option>
  </select>

  <select id="filterPack">
    <option value="">å…¨ãƒ‘ãƒƒã‚¯</option>
  </select>
</div>

<table>
<thead>
<tr>
  <th>ç”»</th>
  <th>ã‚«ãƒ¼ãƒ‰</th>
  <th>ç¨®åˆ¥</th>
  <th>æšæ•°</th>
  <th>æ“ä½œ</th>
</tr>
</thead>
<tbody id="cardList"></tbody>
</table>

<script>
let cards = JSON.parse(localStorage.getItem("cards")) || [];
let packs = JSON.parse(localStorage.getItem("packs")) || [];

function saveAll() {
  localStorage.setItem("cards", JSON.stringify(cards));
  localStorage.setItem("packs", JSON.stringify(packs));
}

function renderPacks() {
  const area = document.getElementById("packArea");
  const edit = document.getElementById("packEditArea");
  const filter = document.getElementById("filterPack");

  area.innerHTML = "";
  edit.innerHTML = "";
  filter.innerHTML = `<option value="">å…¨ãƒ‘ãƒƒã‚¯</option>`;

  packs.forEach((p, i) => {
    const label = document.createElement("label");
    label.innerHTML = `<input type="radio" name="pack" value="${p}">${p}`;
    area.appendChild(label);

    const row = document.createElement("div");
    row.className = "pack-item";
    row.innerHTML = `
      ${p}
      <button onclick="movePack(${i}, -1)">â†‘</button>
      <button onclick="movePack(${i}, 1)">â†“</button>
      <button onclick="deletePack(${i})">å‰Šé™¤</button>
    `;
    edit.appendChild(row);

    const opt = document.createElement("option");
    opt.value = p;
    opt.textContent = p;
    filter.appendChild(opt);
  });
}

function render() {
  const list = document.getElementById("cardList");
  const search = document.getElementById("search").value.toLowerCase();
  const fClass = document.getElementById("filterClass").value;
  const fType = document.getElementById("filterType").value;
  const fPack = document.getElementById("filterPack").value;

  list.innerHTML = "";

  cards.filter(c =>
    (!search || c.name.toLowerCase().includes(search)) &&
    (!fClass || c.classes.includes(fClass)) &&
    (!fType || c.realType === fType) &&
    (!fPack || c.pack === fPack)
  ).forEach((card, index) => {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${card.image ? `<img src="${card.image}">` : ""}</td>
      <td><div class="card-name">${card.name}</div></td>
      <td>${card.realType}</td>
      <td>
        <input class="count-input" type="number" value="${card.count}"
          onchange="updateCount(${index}, this.value)">
      </td>
      <td><button onclick="deleteCard(${index})">å‰Šé™¤</button></td>
    `;
    list.appendChild(row);
  });
}

function addPack() {
  const input = document.getElementById("newPack");
  const name = input.value.trim();
  if (!name || packs.includes(name)) return;
  packs.push(name);
  input.value = "";
  saveAll();
  renderPacks();
}

function movePack(i, d) {
  const t = i + d;
  if (t < 0 || t >= packs.length) return;
  [packs[i], packs[t]] = [packs[t], packs[i]];
  saveAll();
  renderPacks();
}

function deletePack(i) {
  packs.splice(i, 1);
  saveAll();
  renderPacks();
  render();
}

function addCard() {
  const name = document.getElementById("name").value.trim();
  const count = Number(document.getElementById("count").value);
  const classes = Array.from(
    document.querySelectorAll("#classArea input:checked")
  ).map(c => c.value);
  const packRadio = document.querySelector("input[name='pack']:checked");
  const pack = packRadio ? packRadio.value : "";
  const realType = document.querySelector("input[name='realType']:checked").value;
  const imageInput = document.getElementById("image");

  if (!name || !count || classes.length === 0) return;

  const add = image => {
    cards.push({ name, classes, pack, realType, count, image });
    saveAll();
    render();
  };

  if (imageInput.files.length) {
    const r = new FileReader();
    r.onload = () => add(r.result);
    r.readAsDataURL(imageInput.files[0]);
  } else add("");

  document.querySelectorAll("input").forEach(i => i.value = "");
  document.querySelectorAll("#classArea input").forEach(c => c.checked = false);
}

function updateCount(i, v) {
  cards[i].count = Number(v);
  saveAll();
}

function deleteCard(i) {
  cards.splice(i, 1);
  saveAll();
  render();
}

document.querySelectorAll("#search, #filterClass, #filterType, #filterPack")
  .forEach(el => el.addEventListener("input", render));

renderPacks();
render();
</script>

</body>
</html>
